<div class="container py-5" ng-controller="OrderHistoryController as ordersCtrl">
    <h2 class="mb-4" style="color: #6f42c1;">Your Order History</h2>
    <div class="text-center" ng-if="ordersCtrl.loading">
        <div class="spinner-border" style="color: #6f42c1;" role="status"></div>
    </div>
    <div class="alert alert-danger" ng-if="ordersCtrl.error">
        {{ ordersCtrl.error }}
    </div>
    <div class="row" ng-if="!ordersCtrl.loading && !ordersCtrl.error">
        <div class="col-12 text-center" ng-if="ordersCtrl.orders.length === 0">
            <h4 class="text-muted">No orders found</h4>
        </div>
        <div class="col-12 mb-4" ng-repeat="order in ordersCtrl.orders">
            <div class="card shadow-sm mb-3" style="border-left: 4px solid #6f42c1;">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <span class="fw-bold" style="color: #6f42c1;">Order Id #{{ order.id }}</span>
                    <span class="text-muted">Ordered on: {{ order.order_date }}</span>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3 text-md-end mb-3">
                            <h5 class="mb-2">Total: Rs.{{ order.total_price }}</h5>
                            <!-- <button class="btn btn-sm"
                                    ng-class="{'btn-secondary': order.order_status === 'Delivered'}"
                                    ng-style="order.order_status !== 'Delivered' && {'background-color': '#6f42c1', 'color': 'white'}"
                                    ng-disabled="order.order_status === 'Delivered'">
                                {{ order.order_status === 'P' ? 'Not Delivered' : 'Delivered' }}
                            </button> -->
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3" ng-repeat="product in order.detailed_product_list">
                            <div class="card h-100">
                                <img ng-src="{{ordersCtrl.getImageUrl(product.product_image)}}" alt="{{product.product_name}}" class="card-img-top" 
                                     style="height: 200px; object-fit: cover;">
                                <div class="card-body">
                                    <h5 class="card-title" style="color: #6f42c1;">{{ product.product_name }}</h5>
                                    <p class="card-text"><strong>Price:</strong> Rs.{{ product.product_price }}</p>
                                    <p class="card-text"><strong>Quantity:</strong> {{ product.quantity }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 mb-3 mb-m-1 order-md-1 text-md-left">
            <a ui-sref="main" class="btn my-2 my-sm-0" style="border: none;">
                <svg xmlns="http://www.w3.org/2000/svg" width="1.5em" height="1.2em" viewBox="0 0 24 24">
                    <path fill="black" d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42a.996.996 0 0 0-1.41 0l-6.59 6.59a.996.996 0 0 0 0 1.41l6.59 6.59a.996.996 0 1 0 1.41-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1"/>
                </svg> Continue Shopping
            </a>
        </div>
    </div>
</div>

